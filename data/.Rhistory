SocJoy <- ggplot(df, aes(y = factor(year), x = correctsocdem)) +
geom_density_ridges(alpha = 0.5) +
theme_classic() + theme(axis.line = element_line(colour = "black"),
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(hjust = 1)) +
scale_x_continuous(breaks = c(-2, -1, 0, 1, 2, 3),
labels = c("-2\nMost Left-Wing Policy",
"-1", "0", "1", "2",
"3\nMost Right-Wing Policy"))+
labs(x = "Municipal Fiscal Policy", y = NULL)
SocJoy
SocJoy <- ggplot(df, aes(y = factor(year), x = correctsocdem)) +
geom_density_ridges(alpha = 0.5) +
theme_classic() + theme(axis.line = element_line(colour = "black"),
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(hjust = 1)) +
scale_x_continuous(breaks = c(-2, -1, 0, 1, 2, 3),
labels = c("-2\n     Most Left-Wing Policy",
"-1", "0", "1", "2",
"3\n      Most Right-Wing Policy"))+
labs(x = "Municipal Fiscal Policy", y = NULL)
SocJoy
SocJoy <- ggplot(df, aes(y = factor(year), x = correctsocdem)) +
geom_density_ridges(alpha = 0.5) +
theme_classic() + theme(axis.line = element_line(colour = "black"),
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(hjust = 1)) +
scale_x_continuous(breaks = c(-2, -1, 0, 1, 2, 3),
labels = c("-2\n     Most Left-Wing Policy",
"-1", "0", "1", "2",
"3\n                  Most Right-Wing Policy"))+
labs(x = "Municipal Fiscal Policy", y = NULL)
SocJoy
SocJoy <- ggplot(df, aes(y = factor(year), x = correctsocdem)) +
geom_density_ridges(alpha = 0.5) +
theme_classic() + theme(axis.line = element_line(colour = "black"),
plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(hjust = 1)) +
scale_x_continuous(breaks = c(-2, -1, 0, 1, 2, 3),
labels = c("-2\n  Left-Wing Policy",
"-1", "0", "1", "2",
"3\n  Right-Wing Policy"))+
labs(x = "Municipal Fiscal Policy", y = NULL)
SocJoy
ggsave(plot = SocJoy, filename = "ConservatismJOY_trend_24092018.eps", device = cairo_ps)
ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(alpha = .5) +
theme_classic
ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(alpha = .5) +
theme_classic()
ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(alpha = .5, group = muni) +
theme_classic()
ggplot(df, aes(x = year, y = correctsocdem, group = muni)) +
geom_line(alpha = .5) +
theme_classic()
ggplot(df, aes(x = year, y = correctsocdem, group = muni)) +
geom_line(alpha = .2) +
theme_classic()
ggplot(df, aes(x = year, y = correctsocdem, group = muni)) +
geom_line(alpha = .2, colour = "grey") +
theme_classic()
ggplot(df, aes(x = year, y = correctsocdem, group = muni)) +
geom_line(alpha = .3, colour = "grey") +
theme_classic()
ggplot(df, aes(x = year, y = correctsocdem, group = muni)) +
geom_line(alpha = .5, colour = "grey") +
theme_classic()
ggplot(df, aes(x = year, y = correctsocdem, group = muni)) +
geom_line(alpha = .5, colour = "grey") +
theme_classic() +
geom_smooth(se=F, colour = black)
ggplot(df, aes(x = year, y = correctsocdem, group = muni)) +
geom_line(alpha = .5, colour = "grey") +
theme_classic() +
geom_smooth(se=F, colour = "black")
ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(aes(group = muni),alpha = .5, colour = "grey") +
theme_classic() +
geom_smooth(se=F, colour = "black")
ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(aes(group = muni),alpha = .7, colour = "grey") +
theme_classic() +
geom_smooth(se=F, colour = "black")
ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(aes(group = muni),alpha = .1,
colour = "black") +
theme_classic() +
geom_smooth(se=F, colour = "black")
ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(aes(group = muni),alpha = .1,
colour = "black") +
theme_classic() +
geom_smooth(se=F, colour = "black") +
labs(x = NULL,
y = "Fiscal Conservatism") +
scale_y_continuous(breaks = c(-2, -1, 0, 1, 2, 3),
labels = c("-2\n  Left-Wing Policy",
"-1", "0", "1", "2",
"3\n  Right-Wing Policy"))
ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(aes(group = muni),alpha = .1,
colour = "black") +
theme_classic() +
geom_smooth(se=F, colour = "black") +
labs(x = NULL,
y = "Fiscal Conservatism") +
scale_y_continuous(breaks = c(-2, -1, 0, 1, 2, 3),
labels = c(" Left-Wing Policy\n-2",
"-1", "0", "1", "2",
"Right-Wing Policy\n3"))
ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(aes(group = muni),alpha = .1,
colour = "black") +
theme_classic() +
geom_smooth(se=F, colour = "black") +
labs(x = NULL,
y = "Fiscal Conservatism") +
scale_y_continuous(breaks = c(-2, -1, 0, 1, 2, 3),
labels = c("-2\nLeft-Wing Policy",
"-1", "0", "1", "2",
"Right-Wing Policy\n3"))
ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(aes(group = muni),alpha = .08,
colour = "black") +
theme_classic() +
geom_smooth(se=F, colour = "black") +
labs(x = NULL,
y = "Fiscal Conservatism") +
scale_y_continuous(breaks = c(-2, -1, 0, 1, 2, 3),
labels = c("-2\nLeft-Wing Policy",
"-1", "0", "1", "2",
"Right-Wing Policy\n3"))
ptime <- ggplot(df, aes(x = year, y = correctsocdem)) +
geom_line(aes(group = muni),alpha = .08,
colour = "black") +
theme_classic() +
geom_smooth(se=F, colour = "black") +
labs(x = NULL,
y = "Fiscal Conservatism") +
scale_y_continuous(breaks = c(-2, -1, 0, 1, 2, 3),
labels = c("-2\nLeft-Wing Policy",
"-1", "0", "1", "2",
"Right-Wing Policy\n3"))
setwd("~/GitHub/Danish_muni/images")
ggsave(ptime, filename = "fiscal_TimeSeries.eps",
cairo_ps)
library(tmap)
pack<-c("rgdal", "classInt", "GISTools", "maps", "dismo", "raster", "foreign", "shape")
lapply(pack, require, character.only=T)
library(stringr)
data <- "C:/Users/ex-bce/Desktop/responsiveness/KOMMUNAL_SHAPE_UTM32-EUREF89"
muni <- readOGR(dsn=data,
layer="Kommune")
muni <- subset(muni, duplicated(navn) == F)
test <- muni@data
View(test)
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã~",
replacement = "Ø")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã",
replacement = "ø")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã¸",
replacement = "ø")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "ø¸",
replacement = "ø")
#Å
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã.",
replacement = "Å")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "ø.",
replacement = "Å")
#å
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã¥",
replacement = "å")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "ø¥",
replacement = "å")
#Æ
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "ø???",
replacement = "Æ")
#æ
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã¦",
replacement = "æ")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "ø¦",
replacement = "æ")
#Kommune
muni@data$navn <- gsub(x= muni@data$navn,
pattern = " Kommune",
replacement = "")
# last corrections!
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Lyngby-Tårbæk",
replacement = "Lyngby-Taarbæk")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Faxe",
replacement = "Fakse")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Lyngby-Tårbæk",
replacement = "Lyngby-Taarbæk")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Holmegård",
replacement = "Holmegaard")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Nykøbing Falsters",
replacement = "Nykøbing Falster")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Åkirkeby",
replacement = "Aakirkeby")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Fåborg",
replacement = "Faaborg")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Hårby",
replacement = "Haarby")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Nørre Åby",
replacement = "Nørre Aaby")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Nørre Åby",
replacement = "Nørre Aaby")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Sydlangelands",
replacement = "Sydlangeland")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Årup",
replacement = "Aarup")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Åbenrå",
replacement = "Aabenraa")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Grenå",
replacement = "Grenaa")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ålestrup",
replacement = "Aalestrup")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Åbybro",
replacement = "Aabybro")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Års",
replacement = "Aars")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Årslev",
replacement = "Aarslev")
test <- muni@data
View(test)
muni <- readOGR(dsn=data,
layer="Kommune")
test <- muni@data
View(test)
View(df)
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã…",
replacement = "Aa")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã¥",
replacement = "Aa")
test <- muni@data
View(test)
muni <- readOGR(dsn=data,
layer="Kommune")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã…",
replacement = "Aa")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã¥",
replacement = "aa")
test <- muni@data
View(test)
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã¸",
replacement = "ø")
test <- muni@data
View(test)
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã¦",
replacement = "æ")
test <- muni@data
View(test)
muni <- subset(muni, duplicated(navn) == F)
test <- muni@data
View(test)
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã˜",
replacement = "Ø")
test <- muni@data
View(test)
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ã†",
replacement = "Æ")
test <- muni@data
View(test)
muni@data$navn <- gsub(x= muni@data$navn,
pattern = " Kommune",
replacement = "")
test <- muni@data
View(test)
View(test)
View(df)
new.df$muniname <- gsub(x= new.df$muniname,
pattern = "Hirsthals",
replacement = "Hirtshals")
df$muniname <- gsub(x= df$muniname,
pattern = "Hirsthals",
replacement = "Hirtshals")
df$muniname <- gsub(x= df$muniname,
pattern = "Årslev",
replacement = "Aarslev")
stringCleaning <- function(x) {
#convert to lower case, remove unconventional characters, extra spaces
stringr::str_trim(tolower(gsub("\\s+", " ", gsub("[^[:space:]A-z0-9]", "", x))))
}
names(muni@data)[2] <- "muniname"
test <- muni@data
View(test)
df1978 <- subset(new.df, year == 1978)
df1993 <- subset(new.df, year == 1993)
df1997 <- subset(new.df, year == 1997)
df2005 <- subset(new.df, year == 2005)
df2001 <- subset(new.df, year == 2001)
df1978 <- subset(df, year == 1978)
df1993 <- subset(df, year == 1993)
df1997 <- subset(new.df, year == 1997)
df2005 <- subset(df, year == 2005)
df2001 <- subset(df, year == 2001)
df1997 <- subset(df, year == 1997)
View(df1978)
names(df1978)[54] <- "SocDem78"
names(df1993)[54] <- "SocDem93"
names(df1997)[54] <- "SocDem97"
names(df2005)[54] <- "SocDem05"
names(df2001)[54] <- "SocDem01"
View(df1978)
muni@data <- left_join(muni@data, df1978, by = "muniname")
muni@data <- left_join(muni@data, df1993, by = "muniname")
muni@data <- left_join(muni@data, df1997, by = "muniname")
muni@data <- left_join(muni@data, df2005, by = "muniname")
muni@data <- left_join(muni@data, df2001, by = "muniname")
test <- muni@data
View(test)
muni@data <- muni@data[,1:9]
test <- muni@data
View(test)
muni@data <- left_join(muni@data, df1978, by = "muniname")
test <- muni@data
View(test)
test2 <- subset(muni@data, is.na(muni)==T)
View(test2)
View(df1978)
muni@data <- left_join(muni@data, df1978, by = "muniname")
test <- muni@data
View(test)
muni@data <- muni@data[,1:9]
test <- muni@data
df1978 <- dplyr::select(df, muniname, muni, year, correctsocdem)
View(df1978)
df1978 <- subset(df, year == 1978)
df1978 <- dplyr::select(df1978, muniname, muni, year, correctsocdem)
View(df1978)
names(df1978)[4] <- "SocDem78"
muni2 <- muni
df1978$muniname <- stringCleaning(df1978$muniname)
muni2@data$muniname <- stringCleaning(muni2@data$muniname)
muni2@data <- left_join(muni2@data, df1978, by = "muniname")
test2 <- muni2@data
View(test2)
test3 <- subset(muni2@data, is.na(muni)==T)
View(test3)
muni@data$muniname <- gsub(x= muni@data$muniname,
pattern = "s Kommune",
replacement = "")
test2 <- muni2@data
test <- muni@data
View(test)
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Ringkøbing-Skjern",
replacement = "Ringkøbing")
muni@data$muniname <- gsub(x= muni@data$muniname,
pattern = "Ringkøbing-Skjern",
replacement = "Ringkøbing")
test <- muni@data
View(test)
View(agg.all)
.98+54
.98+.54
.13/1.52
1.52/.13
.13*1.52
muni@data$muniname <- gsub(x= muni@data$muniname,
pattern = "Aarhus",
replacement = "Århus")
muni@data$navn <- gsub(x= muni@data$navn,
pattern = "Faxe",
replacement = "Fakse")
muni@data$muniname <- gsub(x= muni@data$muniname,
pattern = "Faxe",
replacement = "Fakse")
View(df1978)
muni@data$muniname <- gsub(x= muni@data$muniname,
pattern = "Graasten",
replacement = "Gråsten")
muni@data$muniname <- gsub(x= muni@data$muniname,
pattern = "Nykøbing Falsters",
replacement = "Nykøbing Falster")
muni@data$muniname <- gsub(x= muni@data$muniname,
pattern = "Bornholms",
replacement = "Bornholm")
muni2 <- muni
df1978 <- subset(df, year == 1978)
df1978 <- dplyr::select(df1978, muniname, muni, year, correctsocdem)
names(df1978)[4] <- "SocDem78"
View(df1978)
muni2@data <- left_join(muni2@data, df1978, by = "muniname")
library(tmap)
tm_shape(muni2) +
tm_fill(c("SocDem78"))+
#breaks=c(-0.1, 0, 0.1, 0.15, 0.2, 0.25, 0.3),
#n = 8, palette = list("Reds", "Reds", "Reds"),
#legend.hist = TRUE, frame = TRUE) +
tm_style_grey()
muni2 <- muni
df1978 <- subset(df, year == 1978)
df1978 <- dplyr::select(df1978, muniname, muni, year, correctsocdem)
names(df1978)[4] <- "SocDem78"
df1978$muniname <- stringCleaning(df1978$muniname)
muni2@data$muniname <- stringCleaning(muni2@data$muniname)
muni2@data <- left_join(muni2@data, df1978, by = "muniname")
tm_shape(muni2) +
tm_fill(c("SocDem78"))+
#breaks=c(-0.1, 0, 0.1, 0.15, 0.2, 0.25, 0.3),
#n = 8, palette = list("Reds", "Reds", "Reds"),
#legend.hist = TRUE, frame = TRUE) +
tm_style_grey()
test3 <- subset(muni2@data, is.na(muni)==T)
View(test3)
View(df)
df1981 <- subset(df, year == 1981)
df1981 <- dplyr::select(df1981, muniname, muni, year, correctsocdem)
test2 <- muni2@data
df1981 <- subset(df, year == 1981)
df1981 <- dplyr::select(df1981, muniname, muni, year, correctsocdem)
names(df1981)[4] <- "SocDem81"
df1981$muniname <- stringCleaning(df1981$muniname)
muni2@data$muniname <- stringCleaning(muni2@data$muniname)
muni2@data <- left_join(muni2@data, df1981, by = "muniname")
tm_shape(muni2) +
tm_fill(c("SocDem81"))+
#breaks=c(-0.1, 0, 0.1, 0.15, 0.2, 0.25, 0.3),
#n = 8, palette = list("Reds", "Reds", "Reds"),
#legend.hist = TRUE, frame = TRUE) +
tm_style_grey()
test2 <- muni2@data
df1986 <- subset(df, year == 1986)
muni2 <- muni
df1986 <- subset(df, year == 1986)
df1986 <- dplyr::select(df1986, muniname, muni, year, correctsocdem)
names(df1986)[4] <- "SocDem86"
df1986$muniname <- stringCleaning(df1986$muniname)
muni2@data$muniname <- stringCleaning(muni2@data$muniname)
muni2@data <- left_join(muni2@data, df1986, by = "muniname")
tm_shape(muni2) +
tm_fill(c("SocDem86"))+
#breaks=c(-0.1, 0, 0.1, 0.15, 0.2, 0.25, 0.3),
#n = 8, palette = list("Reds", "Reds", "Reds"),
#legend.hist = TRUE, frame = TRUE) +
tm_style_grey()
View(df1986)
View(df)
df1986 <- subset(df, year == 1986)
df1986 <- dplyr::select(df1986, muniname, muni, year, correctsocdem)
View(df)
View(df1986)
View(df)
df1993 <- subset(df, year == 1993)
df1993 <- dplyr::select(df1993, muniname, muni, year, correctsocdem)
names(df1993)[4] <- "SocDem93"
df1993$muniname <- stringCleaning(df1993$muniname)
muni2@data$muniname <- stringCleaning(muni2@data$muniname)
muni2@data <- left_join(muni2@data, df1993, by = "muniname")
tm_shape(muni2) +
tm_fill(c("SocDem93"))+
#breaks=c(-0.1, 0, 0.1, 0.15, 0.2, 0.25, 0.3),
#n = 8, palette = list("Reds", "Reds", "Reds"),
#legend.hist = TRUE, frame = TRUE) +
tm_style_grey()
muni2@data$SocDem86 <- muni2@data$SocDem86 - mean(muni2@data$SocDem86,na.rm=T)
muni2@data$SocDem93 <- muni2@data$SocDem93 - mean(muni2@data$SocDem93,na.rm=T)
tm_shape(muni2) +
tm_fill(c("SocDem93"))+
#breaks=c(-0.1, 0, 0.1, 0.15, 0.2, 0.25, 0.3),
#n = 8, palette = list("Reds", "Reds", "Reds"),
#legend.hist = TRUE, frame = TRUE) +
tm_style_grey()
tm_shape(muni2) +
tm_fill(c("SocDem86"))+
#breaks=c(-0.1, 0, 0.1, 0.15, 0.2, 0.25, 0.3),
#n = 8, palette = list("Reds", "Reds", "Reds"),
#legend.hist = TRUE, frame = TRUE) +
tm_style_grey()
View(df)
setwd("~/GitHub/Danish_muni/data")
write.csv(df, file = "CityPolicy_25092018.csv")
