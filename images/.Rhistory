fe.inter <- plm(lag_SocDem1 ~ redvote*mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.inter, vcovNW(fe.inter, type = "HC1", cluster = "group"))
marginsplotdf(fe.inter, xterm = "redvote", zterm = "mayor_bin1", zseq=0:1)
fe.inter <- plm(lag_SocDem1 ~ redvote*mayor_bin, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.inter, vcovNW(fe.inter, type = "HC1", cluster = "group"))
fe.inter <- plm(lag_SocDem1 ~ bluevote*mayor_bin, data = pan.dat, model = "within", effects = "twoways")
fe.inter <- plm(lag_SocDem1 ~ blue_vote*mayor_bin, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.inter, vcovNW(fe.inter, type = "HC1", cluster = "group"))
marginsplotdf(fe.inter, xterm = "redvote", zterm = "mayor_bin1", zseq=0:1)
marginsplotdf(fe.inter, xterm = "blue_vote", zterm = "mayor_bin1", zseq=0:1)
marg_fx <- marginsplotdf(fe.inter, xterm = "blue_vote", zterm = "mayor_bin1", zseq=0:1)
ggplot(marg_fx, aes(x = z, y = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se))) +
theme_classic()
View(marg_fx)
ggplot(marg_fx, aes(x = z, y = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic()
ggplot(marg_fx, aes(x = z, y = dydx)) +
geom_point() +
geom_errorbar(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic()
ggplot(marg_fx, aes(x = z, y = dydx)) +
geom_point()
ggplot(marg_fx, aes(y = z, x = dydx)) +
geom_point() +
geom_errorbar(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic()
ggplot(marg_fx, aes(y = z, x = dydx)) +
geom_point() +
geom_errorbar(aes(ymin=dydx-(1.96*se),
ymax=dydx+(1.96*se)),
height=0) +
theme_classic()
ggplot(marg_fx, aes(y = z, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic()
ggplot(marg_fx, aes(y = factor(z), x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic()
marg_fx$party <- c("Social Democrats", "The Liberal Party")
ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic()
ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic() +
scale_x_continuous(limits=c(0,.5))
ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic() +
scale_x_continuous(limits=c(0,.5)) +
geom_vline(xintercept = 0, lty=2)
marg_fx2 <- marginsplotdf(fe.inter, xterm = "blue_vote", zterm = "mayor_bin2", zseq=0:1)
View(marg_fx2)
marg_fx <- marginsplotdf(fe.inter, xterm = "blue_vote", zterm = "mayor_bin1", zseq=0:1)
marg_fx2 <- marginsplotdf(fe.inter, xterm = "blue_vote", zterm = "mayor_bin2", zseq=0:1)
marg_fx <- rbind(marg_fx, marg_fx2)
View(marg_fx)
marg_fx2 <- marginsplotdf(fe.inter, xterm = "blue_vote", zterm = "mayor_bin2", zseq=0:1)
marg_fx <- marginsplotdf(fe.inter, xterm = "blue_vote", zterm = "mayor_bin1", zseq=0:1)
marg_fx <- rbind(marg_fx, marg_fx2[2,])
marg_fx$party <- c("Social Democrats", "The Liberal Party", "Other")
ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic() +
scale_x_continuous(limits=c(0,.5)) +
geom_vline(xintercept = 0, lty=2)
ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic() +
scale_x_continuous(limits=c(0,.5))
ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic()
ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic() +
scale_x_continuous(limits=c(-0.2,.5)) +
geom_vline(xintercept = 0, lty=2)
marg_fx$party <- c("Social Democrats", "The Liberal Party", "Other Party")
ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic() +
scale_x_continuous(limits=c(-0.2,.5)) +
geom_vline(xintercept = 0, lty=2)
ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic() +
scale_x_continuous(limits=c(-0.2,.5)) +
geom_vline(xintercept = 0, lty=2) +
labs(x = "Effect Conditional on Mayoral Party",
y = NULL)
fe.medi <- plm(lag_SocDem1 ~ redvote + mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic() +
scale_x_continuous(limits=c(-0.2,.5)) +
geom_vline(xintercept = 0, lty=2) +
labs(x = "Effect Conditional on Mayoral Party",
y = NULL)
setwd("~/GitHub/Danish_muni/images")
marg_plot<-ggplot(marg_fx, aes(y = party, x = dydx)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic() +
scale_x_continuous(limits=c(-0.2,.5)) +
geom_vline(xintercept = 0, lty=2) +
labs(x = "Effect Conditional on Mayoral Party",
y = NULL)
ggsave(marg_plot, filename = "MargFX_31082018.eps")
coeftest(fe.medi, vcovHC(fe.medi, type = "HC1", cluster = "group"))
medi_res <- data.frame(PE=coef(fe.medi)[1:3],
SE=sqrt(diag(vcovNW(fe.medi, type = "HC1")))[1:3])
View(medi_res)
fe.medi <- plm(lag_SocDem1 ~ blue_vote + mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
medi_res <- data.frame(PE=coef(fe.medi)[1:3],
SE=sqrt(diag(vcovNW(fe.medi, type = "HC1")))[1:3])
View(medi_res)
medi_res <- rbind(medi_res, data.frame(PE=coef(fe.mod)[1],
SE = sqrt(diag(vcovNW(fe.mod, type="HC1")))[1]))
View(medi_res)
coeftest(fe.medi, vcovHC(fe.medi, type = "HC1", cluster = "group"))
pan.dat$mayor_bin <- relevel(pan.dat$mayor_bin, ref = 2)
fe.medi <- plm(lag_SocDem1 ~ blue_vote + mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.medi, vcovHC(fe.medi, type = "HC1", cluster = "group"))
pan.dat$mayor_bin <- relevel(pan.dat$mayor_bin, ref = 3)
fe.medi <- plm(lag_SocDem1 ~ blue_vote + mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.medi, vcovHC(fe.medi, type = "HC1", cluster = "group"))
medi_res <- data.frame(PE=coef(fe.medi)[1:3],
SE=sqrt(diag(vcovNW(fe.medi, type = "HC1")))[1:3])
medi_res <- rbind(medi_res, data.frame(PE=coef(fe.mod)[1],
SE = sqrt(diag(vcovNW(fe.mod, type="HC1")))[1]))
medi_res$spec <- c("W/ Mayoral Party Control", "The Liberal Party", "Social Democrats",
"Baseline Estimate")
medi_res$spec <- factor(res$spec, levels = c("Baseline Estimate",
"W/ Mayoral Party Control",
"The Liberal Party",
"Social Democrats"))
medi_res$spec <- factor(medi_res$spec, levels = c("Baseline Estimate",
"W/ Mayoral Party Control",
"The Liberal Party",
"Social Democrats"))
ggplot(medi_res, aes(y=spec, x = PE)) +
geom_point() +
geom_errorbarh(aes(xmin=dydx-(1.96*se),
xmax=dydx+(1.96*se)),
height=0) +
theme_classic()
ggplot(medi_res, aes(y=spec, x = PE)) +
geom_point() +
geom_errorbarh(aes(xmin=PE-(1.96*SE),
xmax=PE+(1.96*SE)),
height=0) +
theme_classic()
medi_res$spec <- factor(medi_res$spec, levels = c("The Liberal Party",
"Social Democrats",
"W/ Mayoral Party Control",
"Baseline Estimate"))
ggplot(medi_res, aes(y=spec, x = PE)) +
geom_point() +
geom_errorbarh(aes(xmin=PE-(1.96*SE),
xmax=PE+(1.96*SE)),
height=0) +
theme_classic()
ggplot(medi_res, aes(y=spec, x = PE)) +
geom_point() +
geom_errorbarh(aes(xmin=PE-(1.96*SE),
xmax=PE+(1.96*SE)),
height=0) +
theme_classic() +
geom_vline(xintercept = 0, lty = 2)
ggplot(medi_res, aes(y=spec, x = PE)) +
geom_point() +
geom_errorbarh(aes(xmin=PE-(1.96*SE),
xmax=PE+(1.96*SE)),
height=0) +
theme_classic() +
geom_vline(xintercept = 0, lty = 2) +
geom_hline(yintercept = .75, lty = 3)
ggplot(medi_res, aes(y=spec, x = PE)) +
geom_point() +
geom_errorbarh(aes(xmin=PE-(1.96*SE),
xmax=PE+(1.96*SE)),
height=0) +
theme_classic() +
geom_vline(xintercept = 0, lty = 2) +
geom_hline(yintercept = 3.5, lty = 3)
ggplot(medi_res, aes(y=spec, x = PE)) +
geom_point() +
geom_errorbarh(aes(xmin=PE-(1.96*SE),
xmax=PE+(1.96*SE)),
height=0) +
theme_classic() +
geom_vline(xintercept = 0, lty = 2) +
geom_hline(yintercept = 3.5, lty = 3) +
labs(x="Estimated Coefficient", y = NULL)
pan.dat$mayor_bin <- relevel(pan.dat$mayor_bin, ref = 1)
fe.medi <- plm(lag_SocDem1 ~ blue_vote + mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.medi, vcovHC(fe.medi, type = "HC1", cluster = "group"))
pan.dat$mayor_bin <- relevel(pan.dat$mayor_bin, ref = 0)
fe.medi <- plm(lag_SocDem1 ~ blue_vote + mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
pan.dat$mayor_bin <- relevel(pan.dat$mayor_bin, ref = 1)
fe.medi <- plm(lag_SocDem1 ~ blue_vote + mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.medi, vcovHC(fe.medi, type = "HC1", cluster = "group"))
pan.dat$mayor_bin <- relevel(pan.dat$mayor_bin, ref = 2)
fe.medi <- plm(lag_SocDem1 ~ blue_vote + mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.medi, vcovHC(fe.medi, type = "HC1", cluster = "group"))
pan.dat$mayor_bin <- relevel(pan.dat$mayor_bin, ref = 3)
fe.medi <- plm(lag_SocDem1 ~ blue_vote + mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.medi, vcovHC(fe.medi, type = "HC1", cluster = "group"))
medi_res <- data.frame(PE=coef(fe.medi)[1:3],
SE=sqrt(diag(vcovNW(fe.medi, type = "HC1")))[1:3])
medi_res <- rbind(medi_res, data.frame(PE=coef(fe.mod)[1],
SE = sqrt(diag(vcovNW(fe.mod, type="HC1")))[1]))
medi_res$spec <- c("W/ Mayoral Party Control", "Liberal vs. SocDem", "Other vs. SocDem",
"Baseline Estimate")
medi_res$spec <- factor(medi_res$spec, levels = c("Liberal vs. SocDem",
"Other vs. SocDem",
"W/ Mayoral Party Control",
"Baseline Estimate"))
ggplot(medi_res, aes(y=spec, x = PE)) +
geom_point() +
geom_errorbarh(aes(xmin=PE-(1.96*SE),
xmax=PE+(1.96*SE)),
height=0) +
theme_classic() +
geom_vline(xintercept = 0, lty = 2) +
geom_hline(yintercept = 3.5, lty = 3) +
labs(x="Estimated Coefficient", y = NULL)
pan.dat$mayor_bin <- relevel(pan.dat$mayor_bin, ref = 0)
fe.medi <- plm(lag_SocDem1 ~ blue_vote + mayor_bin+ log_pop, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.medi, vcovHC(fe.medi, type = "HC1", cluster = "group"))
medi_plot<-ggplot(medi_res, aes(y=spec, x = PE)) +
geom_point() +
geom_errorbarh(aes(xmin=PE-(1.96*SE),
xmax=PE+(1.96*SE)),
height=0) +
theme_classic() +
geom_vline(xintercept = 0, lty = 2) +
geom_hline(yintercept = 3.5, lty = 3) +
labs(x="Estimated Coefficient", y = NULL)
ggsave(medi_plot, filename = "PostTreatControl.eps",
device = cairo_ps)
sd(pan.dat$full.SocDem,na.rm=T)
sd(pan.dat$spend.SocDem,na.rm=T)
summary(fe.mod)
sd(plm::Within(pan.dat$full.SocDem, effect = "individual"),na.rm=T)
sd(plm::Within(pan.dat$redvote, effect = "individual"),na.rm=T)
sd(plm::Within(pan.dat$blue_vote, effect = "individual"),na.rm=T)
pan.dat$blue_vote
plm::Within(pan.dat$blue_vote,effect="individual")
plm::Within(pan.dat$redvote,effect="individual")
mod1 <- plm(plm::lag(cons, 4) ~ blue_vote + log_pop, data = pan.dat,
model="within", effect = "twoway")
coeftest(mod1, vcovNW(mod1,type="HC1"))
mod2 <- plm(plm::lag(cons, 0) ~ blue_vote + log_pop, data = pan.dat,
model="within", effect = "twoway")
coeftest(mod2, vcovNW(mod2,type="HC1"))
mod3 <- plm(plm::lag(cons, -1) ~ blue_vote + log_pop, data = pan.dat,
model="within", effect = "twoway")
coeftest(mod3, vcovNW(mod3,type="HC1"))
mod4 <- plm(plm::lag(cons, -4) ~ blue_vote + log_pop, data = pan.dat,
model="within", effect = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
fe.mod <- plm(lag_SocDem1 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(fe.mod, vcovNW(fe.mod, type = "HC1", cluster = "group"))
mod4 <- plm(plm::lag(cons, -4) ~ redvote + log_pop, data = pan.dat,
model="within", effect = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
mod4 <- plm(plm::lag(full.SocDem, -4) ~ redvote + log_pop, data = pan.dat,
model="within", effect = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
fe.mod <- plm(plm::lag(full.SocDem) ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(fe.mod, vcovNW(fe.mod, type = "HC1", cluster = "group"))
df <- read_csv("~/GitHub/Danish_muni/data/full_data_SameScale.csv")
pan.dat <- pdata.frame(df, index = c("muniname", "year")) # reformat data as panel
pan.dat$mayor_bin <- as.factor(ifelse(pan.dat$mayor == "a", 0,
ifelse(pan.dat$mayor == "v", 1, 2)))
mod4 <- plm(plm::lag(full.SocDem, -4) ~ redvote + log_pop, data = pan.dat,
model="within", effect = "twoway")
pan.dat$log_pop <- log(pan.dat$estpop)
mod4 <- plm(plm::lag(full.SocDem, -4) ~ redvote + log_pop, data = pan.dat,
model="within", effect = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
pan.dat$lag_SocDem1 <- plm::lag(pan.dat$full.SocDem,-4) # full measure
pool.mod <- plm(lag_SocDem1 ~ redvote+ log_pop, data = pan.dat ,
model = "pooling")
coeftest(pool.mod, vcovNW(pool.mod, type = "HC1", cluster = "group"))
fe.mod <- plm(lag_SocDem1 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(fe.mod, vcovNW(fe.mod, type = "HC1", cluster = "group"))
pan.dat$plac <- plm::lag(pan.dat$full.SocDem, 4)
pan.dat$SocDem1 <- plm::lag(pan.dat$full.SocDem, -1)
pan.dat$SocDem4 <- plm::lag(pan.dat$full.SocDem, -4)
pan.dat$SocDem8 <- plm::lag(pan.dat$full.SocDem, -8)
pan.dat$SocDem12 <- plm::lag(pan.dat$full.SocDem, -12)
pan.dat$SocDem16 <- plm::lag(pan.dat$full.SocDem, -16)
pan.dat$SocDem20 <- plm::lag(pan.dat$full.SocDem, -20)
mod4 <- plm(SocDem4 ~ redvote + log_pop, data = pan.dat,
model="within", effect = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
cor(pan.dat$SocDem4, pan.dat$lag_SocDem1,use="pairwise.complete.obs")
mod4 <- plm(lag_SocDem1 ~ redvote + log_pop, data = pan.dat,
model="within", effect = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
fe.mod <- plm(lag_SocDem1 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(fe.mod, vcovNW(fe.mod, type = "HC1", cluster = "group"))
mod4 <- plm(lag_SocDem1 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
mod4 <- plm(SocDem4 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
mod5 <- plm(SocDem4 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod5, vcovNW(mod5,type="HC1"))
mod5 <- plm(SocDem8 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod5, vcovNW(mod5,type="HC1"))
mod6 <- plm(SocDem12 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod6, vcovNW(mod6,type="HC1"))
mod7 <- plm(SocDem16 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod7, vcovNW(mod7,type="HC1"))
mod8 <- plm(SocDem20 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod8, vcovNW(mod8,type="HC1"))
mod1 <- plm(plac ~ redvote + log_pop, data = pan.dat,
model="within", effect = "twoway")
coeftest(mod1, vcovNW(mod1,type="HC1"))
mod2 <- plm(full.SocDem ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod2, vcovNW(mod2,type="HC1"))
mod3 <- plm(lag(SocDem1 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod3, vcovNW(mod3,type="HC1"))
mod4 <- plm(SocDem4 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
mod5 <- plm(SocDem8 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod5, vcovNW(mod5,type="HC1"))
mod6 <- plm(SocDem12 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod6, vcovNW(mod6,type="HC1"))
mod7 <- plm(SocDem16 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod7, vcovNW(mod7,type="HC1"))
mod8 <- plm(SocDem20 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod8, vcovNW(mod8,type="HC1"))
##################################################################
#
# The mechanism: responsiveness or selection?
#
#################################################################
# function for computing marginal effects
marginsplotdf<-function(model, xterm, zterm, zseq){
coefs<-coef(model)
cov<-vcovNW(model, type = "HC1")
intterm<-ifelse(is.na(coefs[paste(xterm,zterm,sep=":")]),paste(zterm,xterm,sep=":"),paste(xterm,zterm,sep=":"))
dy.dx<-coefs[xterm]+coefs[intterm]*zseq
se.dy.dx<-sqrt(cov[xterm,xterm]+zseq^2*cov[intterm,intterm]+zseq*2*cov[xterm,intterm])
margins<-data.frame(z=zseq,dydx=dy.dx,se=se.dy.dx)
return(margins)
}
# do politicians from both major parties respond equally?
# interaction models
#2way FE model
fe.inter <- plm(lag_SocDem1 ~ blue_vote*mayor_bin, data = pan.dat, model = "within", effects = "twoways")
coeftest(fe.inter, vcovNW(fe.inter, type = "HC1", cluster = "group"))
mod3 <- plm(SocDem1 ~ redvote+ log_pop, data = pan.dat, model = "within", effects = "twoway")
coeftest(mod3, vcovNW(mod3,type="HC1"))
mod4 <- plm(SocDem4 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
mod5 <- plm(SocDem8 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod5, vcovNW(mod5,type="HC1"))
mod6 <- plm(SocDem12 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod6, vcovNW(mod6,type="HC1"))
mod7 <- plm(SocDem16 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod7, vcovNW(mod7,type="HC1"))
mod8 <- plm(SocDem20 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod8, vcovNW(mod8,type="HC1"))
df <- read_csv("~/GitHub/Danish_muni/data/full_data_SameScale.csv")
pan.dat <- pdata.frame(df, index = c("muniname", "year")) # reformat data as panel
pan.dat$mayor_bin <- as.factor(ifelse(pan.dat$mayor == "a", 0,
ifelse(pan.dat$mayor == "v", 1, 2)))
pan.dat$lag_SocDem1 <- plm::lag(pan.dat$same.SocDem,-4) # full measure
pan.dat$fd_SocDem <- pan.dat$lag_SocDem1 - pan.dat$same.SocDem #FD full measure
pan.dat$lag_redvote <- plm::lag(pan.dat$redvote, 4)
pan.dat$fd_redvote <- pan.datredvote - pan.dat$lag_redvote
pan.dat$fd_redvote <- pan.dat$redvote - pan.dat$lag_redvote
pan.dat$log_pop <- log(pan.dat$estpop) # log transform
pan.dat$lag_pop <- plm::lag(pan.dat$log_pop, 4) #four-year lag
pan.dat$fd_pop <- pan.dat$log_pop - pan.dat$lag_pop #four-year difference
ggplot(pan.dat, aes(x = fd_redvote, y = fd_SocDem)) +
geom_point(alpha = .1) +
geom_smooth(method = "lm", se = F, colour = "black") +
theme_classic() +
labs(x = "Difference in prop. votes for the Right-Wing Parties\n(Since last election)",
y = "Difference in Fiscal Conservatism\n(Between this and next election)")
pool.mod <- plm(lag_SocDem1 ~ redvote+ log_pop, data = pan.dat ,
model = "pooling")
coeftest(pool.mod, vcovNW(pool.mod, type = "HC1", cluster = "group"))
pool.mod.red <- plm(lead_SocDem_reduced ~ redvote+ log_pop, data = pan.dat,
model = "pooling")
fe.mod <- plm(lag_SocDem1 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(fe.mod, vcovNW(fe.mod, type = "HC1", cluster = "group"))
pan.dat$plac <- plm::lag(pan.dat$same.SocDem, 4)
pan.dat$SocDem1 <- plm::lag(pan.dat$same.SocDem, -1)
pan.dat$SocDem4 <- plm::lag(pan.dat$same.SocDem, -4)
pan.dat$SocDem8 <- plm::lag(pan.dat$same.SocDem, -8)
pan.dat$SocDem12 <- plm::lag(pan.dat$same.SocDem, -12)
pan.dat$SocDem16 <- plm::lag(pan.dat$same.SocDem, -16)
pan.dat$SocDem20 <- plm::lag(pan.dat$same.SocDem, -20)
mod1 <- plm(plac ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod1, vcovNW(mod1,type="HC1"))
mod2 <- plm(same.SocDem ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod2, vcovNW(mod2,type="HC1"))
mod3 <- plm(SocDem1 ~ redvote+ log_pop, data = pan.dat, model = "within", effects = "twoway")
coeftest(mod3, vcovNW(mod3,type="HC1"))
mod4 <- plm(SocDem4 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod4, vcovNW(mod4,type="HC1"))
mod5 <- plm(SocDem8 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod5, vcovNW(mod5,type="HC1"))
mod6 <- plm(SocDem12 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod6, vcovNW(mod6,type="HC1"))
mod7 <- plm(SocDem16 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod7, vcovNW(mod7,type="HC1"))
mod8 <- plm(SocDem20 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod8, vcovNW(mod8,type="HC1"))
pan.dat$plac <- plm::lag(pan.dat$full.SocDem, 4)
pan.dat$SocDem1 <- plm::lag(pan.dat$full.SocDem, -1)
pan.dat$SocDem4 <- plm::lag(pan.dat$full.SocDem, -4)
pan.dat$SocDem8 <- plm::lag(pan.dat$full.SocDem, -8)
pan.dat$SocDem12 <- plm::lag(pan.dat$full.SocDem, -12)
pan.dat$SocDem16 <- plm::lag(pan.dat$full.SocDem, -16)
pan.dat$SocDem20 <- plm::lag(pan.dat$full.SocDem, -20)
mod1 <- plm(plac ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod1, vcovHC(mod1,type="HC1", cluster = "group"))
mod2 <- plm(full.SocDem ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod2, vcovHC(mod2,type="HC1", cluster = "group"))
mod3 <- plm(SocDem1 ~ redvote+ log_pop, data = pan.dat, model = "within", effects = "twoway")
coeftest(mod3, vcovHC(mod3,type="HC1", cluster = "group"))
mod4 <- plm(SocDem4 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod4, vcovHC(mod4,type="HC1", cluster = "group"))
mod5 <- plm(SocDem8 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod5, vcovHC(mod5,type="HC1", cluster = "group"))
mod6 <- plm(SocDem12 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod6, vcovHC(mod6,type="HC1", cluster = "group"))
mod2 <- plm(full.SocDem ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod2, vcovHC(mod2,type="HC1", cluster = "group"))
mod1 <- plm(plac ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod1, vcovHC(mod1,type="HC1", cluster = "group"))
summary(plm(SocDem4 ~ full.SocDem, model="within",effect="twoway",data=pan.dat))
mod3 <- plm(SocDem1 ~ redvote+ log_pop + full.SocDem, data = pan.dat, model = "within", effects = "twoway")
coeftest(mod3, vcovHC(mod3,type="HC1", cluster = "group"))
mod2 <- plm(full.SocDem ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod2, vcovHC(mod2,type="HC1", cluster = "group"))
mod4 <- plm(SocDem4 ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod4, vcovHC(mod4,type="HC1", cluster = "group"))
test <- plm(plm::lag(redvote,-4) ~ full.SocDem,data="pan.dat",
model="within", effects="twoway")
test <- plm(plm::lag(redvote,-4) ~ full.SocDem,data=pan.dat,
model="within", effects="twoway")
summary(test)
mod2 <- plm(full.SocDem ~ blue_vote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
mod1 <- plm(plac ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod1, vcovHC(mod1,type="HC1", cluster = "group"))
mod1 <- plm(plac ~ redvote, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod1, vcovHC(mod1,type="HC1", cluster = "group"))
mod2 <- plm(full.SocDem ~ blue_vote, data = pan.dat , model = "within", effects = "twoway")
mod2 <- plm(full.SocDem ~ redvote, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod2, vcovHC(mod2,type="HC1", cluster = "group"))
mod2 <- plm(full.SocDem ~ redvote+ log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod2, vcovHC(mod2,type="HC1", cluster = "group"))
mod1 <- plm(plac ~ redvote + log_pop, data = pan.dat , model = "within", effects = "twoway")
coeftest(mod1, vcovHC(mod1,type="HC1", cluster = "group"))
